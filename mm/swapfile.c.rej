--- mm/swapfile.c
+++ mm/swapfile.c
@@ -512,7 +512,11 @@
 /*
  * How many references to page are currently swapped out?
  */
+#ifdef CONFIG_KRG_MM
+int page_swapcount(struct page *page)
+#else
 static inline int page_swapcount(struct page *page)
+#endif
 {
 	int count = 0;
 	struct swap_info_struct *p;
@@ -1004,7 +1013,11 @@
 			if (start_mm == &init_mm)
 				shmem = shmem_unuse(entry, page);
 			else
+#ifdef CONFIG_KRG_FAF
+				retval = __unuse_mm(start_mm, entry, page);
+#else
 				retval = unuse_mm(start_mm, entry, page);
+#endif
 		}
 		if (*swap_map > 1) {
 			int set_start_mm = (*swap_map >= swcount);
@@ -1034,7 +1047,11 @@
 					set_start_mm = 1;
 					shmem = shmem_unuse(entry, page);
 				} else
+#ifdef CONFIG_KRG_FAF
+					retval = __unuse_mm(mm, entry, page);
+#else
 					retval = unuse_mm(mm, entry, page);
+#endif
 				if (set_start_mm && *swap_map < swcount) {
 					mmput(new_start_mm);
 					atomic_inc(&mm->mm_users);
